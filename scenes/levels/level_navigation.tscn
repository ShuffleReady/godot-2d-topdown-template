[gd_scene load_steps=12 format=4 uid="uid://di8w8pflxt5c4"]

[ext_resource type="PackedScene" uid="uid://b0b0jp36dubff" path="res://scenes/levels/Level.tscn" id="1_spbgx"]
[ext_resource type="PackedScene" uid="uid://2c84y1k62jlc" path="res://entities/enemies/enemy.tscn" id="2_68cva"]
[ext_resource type="Script" uid="uid://dp66ice2hhj8n" path="res://scripts/state_machine/state_machine.gd" id="3_t4uv3"]
[ext_resource type="Script" uid="uid://blcymmqc06vw2" path="res://scripts/state_machine/states/state_navigation.gd" id="4_seybd"]
[ext_resource type="Script" uid="uid://ddifg1cabao3g" path="res://scripts/state_machine/states/state_idle.gd" id="5_3wcfp"]
[ext_resource type="Script" uid="uid://di3e8lyqvjft4" path="res://scripts/state_machine/states/state_params_setter.gd" id="5_x5hhv"]
[ext_resource type="Script" uid="uid://cmc5vhgmy6nat" path="res://scripts/state_machine/states/state_interact.gd" id="6_101ja"]
[ext_resource type="Script" uid="uid://b6xeyy0l5h482" path="res://scripts/state_machine/states/state_follow.gd" id="6_wl5yp"]
[ext_resource type="PackedScene" uid="uid://bybfkbp6hi8r0" path="res://scenes/system/transfer.tscn" id="7_6ttik"]
[ext_resource type="Script" uid="uid://bgm8n3pwwbymt" path="res://scripts/interaction_area.gd" id="8_0xo8f"]

[sub_resource type="CircleShape2D" id="CircleShape2D_x5hhv"]
radius = 32.0

[node name="Level_navigation" instance=ExtResource("1_spbgx")]

[node name="GameCamera2D" parent="." index="0"]
limit_top = -32
limit_right = 768
limit_bottom = 384

[node name="terrain" parent="Layers" index="0" node_paths=PackedStringArray("obstacle_tilemap")]
tile_map_data = PackedByteArray("AAANAP//CgACAAEAAAANAAAACgACAAEAAAANAAEACgACAAEAAAANAAIACgACAAEAAAANAAYACgACAAEAAAANAAcACgACAAEAAAAOAP//CgACAAEAAAAOAAAACgACAAEAAAAOAAEACgACAAEAAAAOAAIACgACAAEAAAAOAAYACgACAAEAAAAOAAcACgACAAEAAAAOAAgACgACAAEAAAAOAAkACgACAAEAAAAOAAoACgACAAEAAAAOAAsACgACAAEAAAAPAP//CgACAAEAAAAPAAAACgACAAEAAAAPAAEACgACAAEAAAAPAAIACgACAAEAAAAPAAYACgACAAEAAAAPAAcACgACAAEAAAAPAAgACgACAAEAAAAPAAkACgACAAEAAAAPAAoACgACAAEAAAAPAAsACgACAAEAAAAQAAIACgACAAEAAAAQAAMACgACAAEAAAAQAAQACgACAAEAAAAQAAUACgACAAEAAAAQAAYACgACAAEAAAAQAAcACgACAAEAAAAQAAgACgACAAEAAAAQAAkACgACAAEAAAAQAAoACgACAAEAAAAQAAsACgACAAEAAAARAAIACgACAAEAAAARAAMACgACAAEAAAARAAQACgACAAEAAAARAAUACgACAAEAAAARAAYACgACAAEAAAARAAcACgACAAEAAAARAAsACgACAAEAAAASAAIACgACAAEAAAASAAMACgACAAEAAAASAAQACgACAAEAAAASAAUACgACAAEAAAASAAYACgACAAEAAAASAAcACgACAAEAAAASAAsACgACAAEAAAATAP//CgACAAEAAAATAAAACgACAAEAAAATAAEACgACAAEAAAATAAIACgACAAEAAAATAAMACgACAAEAAAATAAYACgACAAEAAAATAAcACgACAAEAAAATAAsACgACAAEAAAAUAP//CgACAAEAAAAUAAAACgACAAEAAAAUAAEACgACAAEAAAAUAAIACgACAAEAAAAUAAMACgACAAEAAAAUAAYACgACAAEAAAAUAAcACgACAAEAAAAUAAgACgACAAEAAAAUAAkACgACAAEAAAAUAAoACgACAAEAAAAUAAsACgACAAEAAAAVAP//CgACAAEAAAAVAAAACgACAAEAAAAVAAEACgACAAEAAAAVAAIACgACAAEAAAAVAAMACgACAAEAAAAVAAYACgACAAEAAAAVAAcACgACAAEAAAAVAAgACgACAAEAAAAVAAkACgACAAEAAAAVAAoACgACAAEAAAAVAAsACgACAAEAAAAWAAEACgACAAEAAAAWAAIACgACAAEAAAAWAAMACgACAAEAAAAWAAQACgACAAEAAAAWAAUACgACAAEAAAAWAAYACgACAAEAAAAWAAcACgACAAEAAAAWAAkACgACAAEAAAAWAAoACgACAAEAAAAWAAsACgACAAEAAAAXAAEACgACAAEAAAAXAAIACgACAAEAAAAXAAMACgACAAEAAAAXAAQACgACAAEAAAAXAAUACgACAAEAAAAXAAYACgACAAEAAAAXAAcACgACAAEAAAAXAAkACgACAAEAAAAXAAoACgACAAEAAAAXAAsACgACAAEAAAANAAMACgACAAEAAAANAAQACgACAAEAAAANAAUACgACAAEAAAANAAgACgACAAEAAAANAAkACgACAAEAAAANAAoACgACAAEAAAANAAsACgACAAEAAAAOAAMACgACAAEAAAAOAAQACgACAAEAAAAOAAUACgACAAEAAAAPAAMACgACAAEAAAAPAAQACgACAAEAAAAPAAUACgACAAEAAAAQAP//CgACAAEAAAAQAAAACgACAAEAAAAQAAEACgACAAEAAAARAP//CgACAAEAAAARAAAACgACAAEAAAARAAEACgACAAEAAAARAAgACgACAAEAAAARAAkACgACAAEAAAARAAoACgACAAEAAAASAP//CgACAAEAAAASAAAACgACAAEAAAASAAEACgACAAEAAAASAAgACgACAAEAAAASAAkACgACAAEAAAASAAoACgACAAEAAAATAAQACgACAAEAAAATAAUACgACAAEAAAATAAgACgACAAEAAAATAAkACgACAAEAAAATAAoACgACAAEAAAAUAAQACgACAAEAAAAUAAUACgACAAEAAAAVAAQACgACAAEAAAAVAAUACgACAAEAAAAWAP//CgACAAEAAAAWAAAACgACAAEAAAAWAAgACgACAAEAAAAXAP//CgACAAEAAAAXAAAACgACAAEAAAAXAAgACgACAAEAAAAAAP//CgACAAEAAAAAAAAACgACAAEAAAAAAAEACgACAAEAAAAAAAIACgACAAEAAAAAAAMACgACAAEAAAAAAAQACgACAAEAAAAAAAUACgACAAEAAAAAAAcACgACAAEAAAAAAAgACgACAAEAAAAAAAoACgACAAEAAAAAAAsACgACAAEAAAABAP//CgACAAEAAAABAAAACgACAAEAAAABAAEACgACAAEAAAABAAIACgACAAEAAAABAAMACgACAAEAAAABAAQACgACAAEAAAABAAUACgACAAEAAAABAAcACgACAAEAAAABAAgACgACAAEAAAABAAsACgACAAEAAAACAP//CgACAAEAAAACAAAACgACAAEAAAACAAEACgACAAEAAAACAAQACgACAAEAAAACAAUACgACAAEAAAACAAYACgACAAEAAAACAAcACgACAAEAAAACAAgACgACAAEAAAACAAsACgACAAEAAAADAP//CgACAAEAAAADAAAACgACAAEAAAADAAQACgACAAEAAAADAAUACgACAAEAAAADAAYACgACAAEAAAADAAcACgACAAEAAAADAAgACgACAAEAAAADAAsACgACAAEAAAAEAP//CgACAAEAAAAEAAAACgACAAEAAAAEAAEACgACAAEAAAAEAAIACgACAAEAAAAEAAMACgACAAEAAAAEAAQACgACAAEAAAAEAAUACgACAAEAAAAEAAYACgACAAEAAAAEAAcACgACAAEAAAAEAAgACgACAAEAAAAEAAsACgACAAEAAAAFAP//CgACAAEAAAAFAAAACgACAAEAAAAFAAEACgACAAEAAAAFAAIACgACAAEAAAAFAAMACgACAAEAAAAFAAQACgACAAEAAAAFAAUACgACAAEAAAAFAAYACgACAAEAAAAFAAcACgACAAEAAAAFAAgACgACAAEAAAAFAAkACgACAAEAAAAFAAoACgACAAEAAAAFAAsACgACAAEAAAAGAP//CgACAAEAAAAGAAAACgACAAEAAAAGAAEACgACAAEAAAAGAAIACgACAAEAAAAGAAMACgACAAEAAAAGAAQACgACAAEAAAAGAAUACgACAAEAAAAGAAgACgACAAEAAAAGAAkACgACAAEAAAAGAAoACgACAAEAAAAGAAsACgACAAEAAAAHAP//CgACAAEAAAAHAAAACgACAAEAAAAHAAEACgACAAEAAAAHAAIACgACAAEAAAAHAAMACgACAAEAAAAHAAQACgACAAEAAAAHAAUACgACAAEAAAAHAAgACgACAAEAAAAHAAkACgACAAEAAAAHAAoACgACAAEAAAAHAAsACgACAAEAAAAIAP//CgACAAEAAAAIAAAACgACAAEAAAAIAAMACgACAAEAAAAIAAQACgACAAEAAAAIAAUACgACAAEAAAAIAAgACgACAAEAAAAIAAkACgACAAEAAAAIAAoACgACAAEAAAAIAAsACgACAAEAAAAJAP//CgACAAEAAAAJAAMACgACAAEAAAAJAAQACgACAAEAAAAJAAUACgACAAEAAAAJAAgACgACAAEAAAAJAAkACgACAAEAAAAJAAoACgACAAEAAAAJAAsACgACAAEAAAAKAP//CgACAAEAAAAKAAIACgACAAEAAAAKAAMACgACAAEAAAAKAAQACgACAAEAAAAKAAUACgACAAEAAAAKAAYACgACAAEAAAAKAAcACgACAAEAAAAKAAgACgACAAEAAAAKAAkACgACAAEAAAAKAAoACgACAAEAAAAKAAsACgACAAEAAAALAP//CgACAAEAAAALAAAACgACAAEAAAALAAEACgACAAEAAAALAAIACgACAAEAAAALAAMACgACAAEAAAALAAQACgACAAEAAAALAAUACgACAAEAAAALAAYACgACAAEAAAALAAcACgACAAEAAAALAAgACgACAAEAAAALAAkACgACAAEAAAALAAoACgACAAEAAAALAAsACgACAAEAAAAMAP//CgACAAEAAAAMAAAACgACAAEAAAAMAAEACgACAAEAAAAMAAIACgACAAEAAAAMAAMACgACAAEAAAAMAAQACgACAAEAAAAMAAUACgACAAEAAAAMAAYACgACAAEAAAAMAAcACgACAAEAAAAMAAgACgACAAEAAAAMAAkACgACAAEAAAAMAAoACgACAAEAAAAMAAsACgACAAEAAAAAAAYACgACAAEAAAAAAAkACgACAAEAAAABAAYACgACAAEAAAABAAkACgACAAEAAAABAAoACgACAAEAAAACAAIACgACAAEAAAACAAMACgACAAEAAAACAAkACgACAAEAAAACAAoACgACAAEAAAADAAEACgACAAEAAAADAAIACgACAAEAAAADAAMACgACAAEAAAADAAkACgACAAEAAAADAAoACgACAAEAAAAEAAkACgACAAEAAAAEAAoACgACAAEAAAAGAAYACgACAAEAAAAGAAcACgACAAEAAAAHAAYACgACAAEAAAAHAAcACgACAAEAAAAIAAEACgACAAEAAAAIAAIACgACAAEAAAAIAAYACgACAAEAAAAIAAcACgACAAEAAAAJAAAACgACAAEAAAAJAAEACgACAAEAAAAJAAIACgACAAEAAAAJAAYACgACAAEAAAAJAAcACgACAAEAAAAKAAAACgACAAEAAAAKAAEACgACAAEAAAA=")
obstacle_tilemap = NodePath("../terrain2")
obstacle_tile_id = 6

[node name="terrain2" parent="Layers" index="2"]
tile_map_data = PackedByteArray("AAACAAMABgALAAIAAAACAAIABgALAAAAAAADAAIABgASAAIAAAADAAEABgAOAAAAAAADAAMABgANAAIAAAAAAAkABgALAAMAAAABAAkABgARAAAAAAACAAkABgAMAAAAAAADAAkABgAMAAAAAAAEAAkABgANAAAAAAABAAoABgALAAIAAAACAAoABgAMAAIAAAADAAoABgAMAAIAAAAEAAoABgANAAIAAAAGAAYABgALAAAAAAAHAAYABgAMAAAAAAAIAAYABgAMAAAAAAAJAAYABgANAAAAAAAJAAcABgANAAIAAAAIAAcABgAMAAIAAAAHAAcABgAMAAIAAAAGAAcABgALAAIAAAAIAAIABgALAAIAAAAIAAEABgALAAAAAAAJAAAABgALAAAAAAAKAAAABgANAAAAAAAKAAEABgANAAIAAAAJAAEABgAUAAEAAAAJAAIABgANAAIAAAAMAAQABgALAAMAAAANAAMABgALAAAAAAAOAAMABgAMAAAAAAAPAAMABgANAAAAAAAPAAQABgANAAEAAAAOAAQABgAMAAEAAAANAAQABgARAAQAAAANAAUABgALAAIAAAAOAAUABgAMAAIAAAAPAAUABgANAAIAAAAMAAsABgALAAIAAAAMAAoABgALAAEAAAAMAAkABgALAAEAAAAMAAgABgALAAAAAAANAAgABgANAAAAAAANAAkABgANAAEAAAANAAoABgANAAEAAAANAAsABgANAAIAAAARAAkABgALAAEAAAARAAgABgALAAAAAAASAAgABgAMAAAAAAATAAkABgANAAEAAAASAAkABgAMAAEAAAASAAoABgAMAAIAAAARAAoABgALAAIAAAATAAoABgANAAIAAAATAAgABgANAAAAAAATAAUABgALAAIAAAAUAAUABgAMAAIAAAAVAAUABgANAAIAAAAVAAQABgANAAAAAAAUAAQABgAMAAAAAAATAAQABgALAAAAAAAQAAAABgALAAEAAAAQAAEABgALAAIAAAARAAEABgAMAAIAAAASAAEABgANAAIAAAASAAAABgANAAEAAAASAP//BgANAAAAAAARAP//BgAMAAAAAAAQAP//BgALAAAAAAARAAAABgAMAAEAAAAWAP//BgALAAAAAAAWAAAABgALAAIAAAAXAAAABgANAAIAAAAXAP//BgANAAAAAAAAAAYABgALAAMAAAABAAYABgANAAMAAAAWAAgABgALAAMAAAAXAAgABgANAAMAAAA=")

[node name="P1" parent="Entities" index="0"]
position = Vector2(169, 92)

[node name="Enemy1" parent="Entities" index="1" instance=ExtResource("2_68cva")]
position = Vector2(176, 16)

[node name="NavigationAgent2D" type="NavigationAgent2D" parent="Entities/Enemy1" index="7"]
path_desired_distance = 30.0
target_desired_distance = 30.0
path_postprocessing = 1
avoidance_mask = 2
debug_enabled = true
debug_use_custom = true
debug_path_custom_color = Color(1, 0, 0, 1)

[node name="StateMachine" type="Node" parent="Entities/Enemy1" index="8" node_paths=PackedStringArray("current_state")]
script = ExtResource("3_t4uv3")
current_state = NodePath("follow")

[node name="follow" type="Node" parent="Entities/Enemy1/StateMachine" index="0" node_paths=PackedStringArray("navigation_agent")]
script = ExtResource("4_seybd")
navigation_agent = NodePath("../../NavigationAgent2D")
target_player_id = 1

[node name="speed-0" type="Node" parent="Entities/Enemy1/StateMachine/follow" index="0"]
script = ExtResource("5_x5hhv")
param_key = "entity"
on_enter = Dictionary[String, Variant]({
"speed_multiplier": 0.0
})
on_exit = Dictionary[String, Variant]({
"speed_multiplier": 1.0
})
metadata/_custom_type_script = ExtResource("5_x5hhv")

[node name="idle" type="Node" parent="Entities/Enemy1/StateMachine" index="1"]
script = ExtResource("5_3wcfp")

[node name="Enemy2" parent="Entities" index="2" instance=ExtResource("2_68cva")]
position = Vector2(224, 0)

[node name="NavigationAgent2D" type="NavigationAgent2D" parent="Entities/Enemy2" index="7"]
path_desired_distance = 30.0
target_desired_distance = 30.0
path_postprocessing = 1
avoidance_mask = 2
debug_enabled = true
debug_use_custom = true
debug_path_custom_color = Color(1, 0, 0, 1)

[node name="InteractionArea" type="Area2D" parent="Entities/Enemy2" index="8"]
z_index = -1
collision_layer = 0
collision_mask = 8
monitorable = false
script = ExtResource("8_0xo8f")
metadata/_custom_type_script = ExtResource("8_0xo8f")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Entities/Enemy2/InteractionArea" index="0"]
shape = SubResource("CircleShape2D_x5hhv")
debug_color = Color(0.627451, 0.52549, 0.231373, 0.419608)

[node name="StateMachine" type="Node" parent="Entities/Enemy2" index="9" node_paths=PackedStringArray("current_state")]
script = ExtResource("3_t4uv3")
current_state = NodePath("follow")

[node name="follow" type="Node" parent="Entities/Enemy2/StateMachine" index="0" node_paths=PackedStringArray("navigation_agent")]
script = ExtResource("4_seybd")
navigation_agent = NodePath("../../NavigationAgent2D")
target_player_id = 1

[node name="to_idle" type="Node" parent="Entities/Enemy2/StateMachine/follow" index="0" node_paths=PackedStringArray("interaction_area", "on_completion")]
script = ExtResource("6_101ja")
interaction_area = NodePath("../../../InteractionArea")
one_shot = false
on_completion = [NodePath("../../idle")]
metadata/_custom_type_script = ExtResource("6_101ja")

[node name="idle" type="Node" parent="Entities/Enemy2/StateMachine" index="1"]
script = ExtResource("5_3wcfp")

[node name="Enemy3" parent="Entities" index="3" instance=ExtResource("2_68cva")]
position = Vector2(112, 16)

[node name="NavigationAgent2D" type="NavigationAgent2D" parent="Entities/Enemy3" index="7"]
path_desired_distance = 30.0
target_desired_distance = 30.0
path_postprocessing = 1
avoidance_mask = 2
debug_enabled = true
debug_use_custom = true
debug_path_custom_color = Color(1, 0, 0, 1)

[node name="StateMachine" type="Node" parent="Entities/Enemy3" index="8" node_paths=PackedStringArray("current_state")]
script = ExtResource("3_t4uv3")
current_state = NodePath("follow")

[node name="follow" type="Node" parent="Entities/Enemy3/StateMachine" index="0"]
script = ExtResource("6_wl5yp")
target_player_id = 1

[node name="idle" type="Node" parent="Entities/Enemy3/StateMachine" index="1"]
script = ExtResource("5_3wcfp")

[node name="Transfer_West" parent="Transfers" index="0" instance=ExtResource("7_6ttik")]
position = Vector2(16, 256)
rotation = 1.5708
level_path = "res://scenes/levels/level_01.tscn"
destination_name = "Transfer_East"
facing = 2

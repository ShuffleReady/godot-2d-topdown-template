[gd_scene load_steps=8 format=4 uid="uid://di8w8pflxt5c4"]

[ext_resource type="PackedScene" uid="uid://8u5h1ar8jt2f" path="res://scenes/levels/Level.tscn" id="1_spbgx"]
[ext_resource type="PackedScene" uid="uid://2c84y1k62jlc" path="res://entities/enemies/enemy.tscn" id="2_68cva"]
[ext_resource type="Script" path="res://scripts/state_machine/scripts/state_machine.gd" id="3_t4uv3"]
[ext_resource type="Script" path="res://scripts/state_machine/states/state_navigation.gd" id="4_seybd"]
[ext_resource type="Script" path="res://scripts/state_machine/states/state_idle.gd" id="5_3wcfp"]
[ext_resource type="Script" path="res://scripts/state_machine/states/state_follow.gd" id="6_wl5yp"]
[ext_resource type="PackedScene" uid="uid://b31ie7ym22i4i" path="res://scenes/system/transfer.tscn" id="7_6ttik"]

[node name="Level_navigation" instance=ExtResource("1_spbgx")]

[node name="GameCamera2D" parent="." index="0"]
limit_left = 0
limit_top = -32
limit_right = 768
limit_bottom = 384

[node name="terrain" parent="Layers" index="0" node_paths=PackedStringArray("obstacle_tilemap")]
tile_map_data = PackedByteArray("AAANAP//CgAEAAMAAAANAAAACgAEAAMAAAANAAEACgAEAAMAAAANAAIACgAEAAMAAAANAAYACgAEAAMAAAANAAcACgAEAAMAAAAOAP//CgAEAAMAAAAOAAAACgAEAAMAAAAOAAEACgAEAAMAAAAOAAIACgAEAAMAAAAOAAYACgAEAAMAAAAOAAcACgAEAAMAAAAOAAgACgAEAAMAAAAOAAkACgAEAAMAAAAOAAoACgAEAAMAAAAOAAsACgAEAAMAAAAPAP//CgAEAAMAAAAPAAAACgAEAAMAAAAPAAEACgAEAAMAAAAPAAIACgAEAAMAAAAPAAYACgAEAAMAAAAPAAcACgAEAAMAAAAPAAgACgAEAAMAAAAPAAkACgAEAAMAAAAPAAoACgAEAAMAAAAPAAsACgAEAAMAAAAQAAIACgAEAAMAAAAQAAMACgAEAAMAAAAQAAQACgAEAAMAAAAQAAUACgAEAAMAAAAQAAYACgAEAAMAAAAQAAcACgAEAAMAAAAQAAgACgAEAAMAAAAQAAkACgAEAAMAAAAQAAoACgAEAAMAAAAQAAsACgAEAAMAAAARAAIACgAEAAMAAAARAAMACgAEAAMAAAARAAQACgAEAAMAAAARAAUACgAEAAMAAAARAAYACgAEAAMAAAARAAcACgAEAAMAAAARAAsACgAEAAMAAAASAAIACgAEAAMAAAASAAMACgAEAAMAAAASAAQACgAEAAMAAAASAAUACgAEAAMAAAASAAYACgAEAAMAAAASAAcACgAEAAMAAAASAAsACgAEAAMAAAATAP//CgAEAAMAAAATAAAACgAEAAMAAAATAAEACgAEAAMAAAATAAIACgAEAAMAAAATAAMACgAEAAMAAAATAAYACgAEAAMAAAATAAcACgAEAAMAAAATAAsACgAEAAMAAAAUAP//CgAEAAMAAAAUAAAACgAEAAMAAAAUAAEACgAEAAMAAAAUAAIACgAEAAMAAAAUAAMACgAEAAMAAAAUAAYACgAEAAMAAAAUAAcACgAEAAMAAAAUAAgACgAEAAMAAAAUAAkACgAEAAMAAAAUAAoACgAEAAMAAAAUAAsACgAEAAMAAAAVAP//CgAEAAMAAAAVAAAACgAEAAMAAAAVAAEACgAEAAMAAAAVAAIACgAEAAMAAAAVAAMACgAEAAMAAAAVAAYACgAEAAMAAAAVAAcACgAEAAMAAAAVAAgACgAEAAMAAAAVAAkACgAEAAMAAAAVAAoACgAEAAMAAAAVAAsACgAEAAMAAAAWAAEACgAEAAMAAAAWAAIACgAEAAMAAAAWAAMACgAEAAMAAAAWAAQACgAEAAMAAAAWAAUACgAEAAMAAAAWAAYACgAEAAMAAAAWAAcACgAEAAMAAAAWAAkACgAEAAMAAAAWAAoACgAEAAMAAAAWAAsACgAEAAMAAAAXAAEACgAEAAMAAAAXAAIACgAEAAMAAAAXAAMACgAEAAMAAAAXAAQACgAEAAMAAAAXAAUACgAEAAMAAAAXAAYACgAEAAMAAAAXAAcACgAEAAMAAAAXAAkACgAEAAMAAAAXAAoACgAEAAMAAAAXAAsACgAEAAMAAAANAAMACgAEAAMAAAANAAQACgAEAAMAAAANAAUACgAEAAMAAAANAAgACgAEAAMAAAANAAkACgAEAAMAAAANAAoACgAEAAMAAAANAAsACgAEAAMAAAAOAAMACgAEAAMAAAAOAAQACgAEAAMAAAAOAAUACgAEAAMAAAAPAAMACgAEAAMAAAAPAAQACgAEAAMAAAAPAAUACgAEAAMAAAAQAP//CgAEAAMAAAAQAAAACgAEAAMAAAAQAAEACgAEAAMAAAARAP//CgAEAAMAAAARAAAACgAEAAMAAAARAAEACgAEAAMAAAARAAgACgAEAAMAAAARAAkACgAEAAMAAAARAAoACgAEAAMAAAASAP//CgAEAAMAAAASAAAACgAEAAMAAAASAAEACgAEAAMAAAASAAgACgAEAAMAAAASAAkACgAEAAMAAAASAAoACgAEAAMAAAATAAQACgAEAAMAAAATAAUACgAEAAMAAAATAAgACgAEAAMAAAATAAkACgAEAAMAAAATAAoACgAEAAMAAAAUAAQACgAEAAMAAAAUAAUACgAEAAMAAAAVAAQACgAEAAMAAAAVAAUACgAEAAMAAAAWAP//CgAEAAMAAAAWAAAACgAEAAMAAAAWAAgACgAEAAMAAAAXAP//CgAEAAMAAAAXAAAACgAEAAMAAAAXAAgACgAEAAMAAAAAAP//CgAEAAMAAAAAAAAACgAEAAMAAAAAAAEACgAEAAMAAAAAAAIACgAEAAMAAAAAAAMACgAEAAMAAAAAAAQACgAEAAMAAAAAAAUACgAEAAMAAAAAAAcACgAEAAMAAAAAAAgACgAEAAMAAAAAAAoACgAEAAMAAAAAAAsACgAEAAMAAAABAP//CgAEAAMAAAABAAAACgAEAAMAAAABAAEACgAEAAMAAAABAAIACgAEAAMAAAABAAMACgAEAAMAAAABAAQACgAEAAMAAAABAAUACgAEAAMAAAABAAcACgAEAAMAAAABAAgACgAEAAMAAAABAAsACgAEAAMAAAACAP//CgAEAAMAAAACAAAACgAEAAMAAAACAAEACgAEAAMAAAACAAQACgAEAAMAAAACAAUACgAEAAMAAAACAAYACgAEAAMAAAACAAcACgAEAAMAAAACAAgACgAEAAMAAAACAAsACgAEAAMAAAADAP//CgAEAAMAAAADAAAACgAEAAMAAAADAAQACgAEAAMAAAADAAUACgAEAAMAAAADAAYACgAEAAMAAAADAAcACgAEAAMAAAADAAgACgAEAAMAAAADAAsACgAEAAMAAAAEAP//CgAEAAMAAAAEAAAACgAEAAMAAAAEAAEACgAEAAMAAAAEAAIACgAEAAMAAAAEAAMACgAEAAMAAAAEAAQACgAEAAMAAAAEAAUACgAEAAMAAAAEAAYACgAEAAMAAAAEAAcACgAEAAMAAAAEAAgACgAEAAMAAAAEAAsACgAEAAMAAAAFAP//CgAEAAMAAAAFAAAACgAEAAMAAAAFAAEACgAEAAMAAAAFAAIACgAEAAMAAAAFAAMACgAEAAMAAAAFAAQACgAEAAMAAAAFAAUACgAEAAMAAAAFAAYACgAEAAMAAAAFAAcACgAEAAMAAAAFAAgACgAEAAMAAAAFAAkACgAEAAMAAAAFAAoACgAEAAMAAAAFAAsACgAEAAMAAAAGAP//CgAEAAMAAAAGAAAACgAEAAMAAAAGAAEACgAEAAMAAAAGAAIACgAEAAMAAAAGAAMACgAEAAMAAAAGAAQACgAEAAMAAAAGAAUACgAEAAMAAAAGAAgACgAEAAMAAAAGAAkACgAEAAMAAAAGAAoACgAEAAMAAAAGAAsACgAEAAMAAAAHAP//CgAEAAMAAAAHAAAACgAEAAMAAAAHAAEACgAEAAMAAAAHAAIACgAEAAMAAAAHAAMACgAEAAMAAAAHAAQACgAEAAMAAAAHAAUACgAEAAMAAAAHAAgACgAEAAMAAAAHAAkACgAEAAMAAAAHAAoACgAEAAMAAAAHAAsACgAEAAMAAAAIAP//CgAEAAMAAAAIAAAACgAEAAMAAAAIAAMACgAEAAMAAAAIAAQACgAEAAMAAAAIAAUACgAEAAMAAAAIAAgACgAEAAMAAAAIAAkACgAEAAMAAAAIAAoACgAEAAMAAAAIAAsACgAEAAMAAAAJAP//CgAEAAMAAAAJAAMACgAEAAMAAAAJAAQACgAEAAMAAAAJAAUACgAEAAMAAAAJAAgACgAEAAMAAAAJAAkACgAEAAMAAAAJAAoACgAEAAMAAAAJAAsACgAEAAMAAAAKAP//CgAEAAMAAAAKAAIACgAEAAMAAAAKAAMACgAEAAMAAAAKAAQACgAEAAMAAAAKAAUACgAEAAMAAAAKAAYACgAEAAMAAAAKAAcACgAEAAMAAAAKAAgACgAEAAMAAAAKAAkACgAEAAMAAAAKAAoACgAEAAMAAAAKAAsACgAEAAMAAAALAP//CgAEAAMAAAALAAAACgAEAAMAAAALAAEACgAEAAMAAAALAAIACgAEAAMAAAALAAMACgAEAAMAAAALAAQACgAEAAMAAAALAAUACgAEAAMAAAALAAYACgAEAAMAAAALAAcACgAEAAMAAAALAAgACgAEAAMAAAALAAkACgAEAAMAAAALAAoACgAEAAMAAAALAAsACgAEAAMAAAAMAP//CgAEAAMAAAAMAAAACgAEAAMAAAAMAAEACgAEAAMAAAAMAAIACgAEAAMAAAAMAAMACgAEAAMAAAAMAAQACgAEAAMAAAAMAAUACgAEAAMAAAAMAAYACgAEAAMAAAAMAAcACgAEAAMAAAAMAAgACgAEAAMAAAAMAAkACgAEAAMAAAAMAAoACgAEAAMAAAAMAAsACgAEAAMAAAAAAAYACgAEAAMAAAAAAAkACgAEAAMAAAABAAYACgAEAAMAAAABAAkACgAEAAMAAAABAAoACgAEAAMAAAACAAIACgAEAAMAAAACAAMACgAEAAMAAAACAAkACgAEAAMAAAACAAoACgAEAAMAAAADAAEACgAEAAMAAAADAAIACgAEAAMAAAADAAMACgAEAAMAAAADAAkACgAEAAMAAAADAAoACgAEAAMAAAAEAAkACgAEAAMAAAAEAAoACgAEAAMAAAAGAAYACgAEAAMAAAAGAAcACgAEAAMAAAAHAAYACgAEAAMAAAAHAAcACgAEAAMAAAAIAAEACgAEAAMAAAAIAAIACgAEAAMAAAAIAAYACgAEAAMAAAAIAAcACgAEAAMAAAAJAAAACgAEAAMAAAAJAAEACgAEAAMAAAAJAAIACgAEAAMAAAAJAAYACgAEAAMAAAAJAAcACgAEAAMAAAAKAAAACgAEAAMAAAAKAAEACgAEAAMAAAA=")
obstacle_tilemap = NodePath("../terrain2")
obstacle_tile_id = 6

[node name="terrain2" parent="Layers" index="2"]
tile_map_data = PackedByteArray("AAACAAMABgALAAIAAAACAAIABgALAAAAAAADAAIABgASAAIAAAADAAEABgAOAAAAAAADAAMABgANAAIAAAAAAAkABgALAAMAAAABAAkABgARAAAAAAACAAkABgAMAAAAAAADAAkABgAMAAAAAAAEAAkABgANAAAAAAABAAoABgALAAIAAAACAAoABgAMAAIAAAADAAoABgAMAAIAAAAEAAoABgANAAIAAAAGAAYABgALAAAAAAAHAAYABgAMAAAAAAAIAAYABgAMAAAAAAAJAAYABgANAAAAAAAJAAcABgANAAIAAAAIAAcABgAMAAIAAAAHAAcABgAMAAIAAAAGAAcABgALAAIAAAAIAAIABgALAAIAAAAIAAEABgALAAAAAAAJAAAABgALAAAAAAAKAAAABgANAAAAAAAKAAEABgANAAIAAAAJAAEABgAUAAEAAAAJAAIABgANAAIAAAAMAAQABgALAAMAAAANAAMABgALAAAAAAAOAAMABgAMAAAAAAAPAAMABgANAAAAAAAPAAQABgANAAEAAAAOAAQABgAMAAEAAAANAAQABgARAAQAAAANAAUABgALAAIAAAAOAAUABgAMAAIAAAAPAAUABgANAAIAAAAMAAsABgALAAIAAAAMAAoABgALAAEAAAAMAAkABgALAAEAAAAMAAgABgALAAAAAAANAAgABgANAAAAAAANAAkABgANAAEAAAANAAoABgANAAEAAAANAAsABgANAAIAAAARAAkABgALAAEAAAARAAgABgALAAAAAAASAAgABgAMAAAAAAATAAkABgANAAEAAAASAAkABgAMAAEAAAASAAoABgAMAAIAAAARAAoABgALAAIAAAATAAoABgANAAIAAAATAAgABgANAAAAAAATAAUABgALAAIAAAAUAAUABgAMAAIAAAAVAAUABgANAAIAAAAVAAQABgANAAAAAAAUAAQABgAMAAAAAAATAAQABgALAAAAAAAQAAAABgALAAEAAAAQAAEABgALAAIAAAARAAEABgAMAAIAAAASAAEABgANAAIAAAASAAAABgANAAEAAAASAP//BgANAAAAAAARAP//BgAMAAAAAAAQAP//BgALAAAAAAARAAAABgAMAAEAAAAWAP//BgALAAAAAAAWAAAABgALAAIAAAAXAAAABgANAAIAAAAXAP//BgANAAAAAAAAAAYABgALAAMAAAABAAYABgANAAMAAAAWAAgABgALAAMAAAAXAAgABgANAAMAAAA=")

[node name="P1" parent="Entities" index="0"]
position = Vector2(256, 304)

[node name="Enemy1" parent="Entities" index="1" instance=ExtResource("2_68cva")]
position = Vector2(176, 16)

[node name="NavigationAgent2D" type="NavigationAgent2D" parent="Entities/Enemy1" index="7"]
path_desired_distance = 30.0
target_desired_distance = 30.0
path_postprocessing = 1
avoidance_mask = 2
debug_enabled = true
debug_use_custom = true
debug_path_custom_color = Color(1, 0, 0, 1)

[node name="StateMachine" type="Node" parent="Entities/Enemy1" index="8" node_paths=PackedStringArray("current_state")]
script = ExtResource("3_t4uv3")
current_state = NodePath("follow")

[node name="follow" type="Node" parent="Entities/Enemy1/StateMachine" index="0" node_paths=PackedStringArray("navigation_agent", "on_target_reached")]
script = ExtResource("4_seybd")
navigation_agent = NodePath("../../NavigationAgent2D")
target_player_id = 1
on_target_reached = NodePath("../idle")

[node name="idle" type="Node" parent="Entities/Enemy1/StateMachine" index="1"]
script = ExtResource("5_3wcfp")

[node name="Enemy2" parent="Entities" index="2" instance=ExtResource("2_68cva")]
position = Vector2(224, 0)

[node name="NavigationAgent2D" type="NavigationAgent2D" parent="Entities/Enemy2" index="7"]
path_desired_distance = 30.0
target_desired_distance = 30.0
path_postprocessing = 1
avoidance_mask = 2
debug_enabled = true
debug_use_custom = true
debug_path_custom_color = Color(1, 0, 0, 1)

[node name="StateMachine" type="Node" parent="Entities/Enemy2" index="8" node_paths=PackedStringArray("current_state")]
script = ExtResource("3_t4uv3")
current_state = NodePath("follow")

[node name="follow" type="Node" parent="Entities/Enemy2/StateMachine" index="0" node_paths=PackedStringArray("navigation_agent", "on_target_reached")]
script = ExtResource("4_seybd")
navigation_agent = NodePath("../../NavigationAgent2D")
target_player_id = 1
on_target_reached = NodePath("../idle")

[node name="idle" type="Node" parent="Entities/Enemy2/StateMachine" index="1"]
script = ExtResource("5_3wcfp")

[node name="Enemy3" parent="Entities" index="3" instance=ExtResource("2_68cva")]
position = Vector2(112, 16)

[node name="NavigationAgent2D" type="NavigationAgent2D" parent="Entities/Enemy3" index="7"]
path_desired_distance = 30.0
target_desired_distance = 30.0
path_postprocessing = 1
avoidance_mask = 2
debug_enabled = true
debug_use_custom = true
debug_path_custom_color = Color(1, 0, 0, 1)

[node name="StateMachine" type="Node" parent="Entities/Enemy3" index="8" node_paths=PackedStringArray("current_state")]
script = ExtResource("3_t4uv3")
current_state = NodePath("follow")

[node name="follow" type="Node" parent="Entities/Enemy3/StateMachine" index="0" node_paths=PackedStringArray("on_target_reached")]
script = ExtResource("6_wl5yp")
target_player_id = 1
on_target_reached = NodePath("../idle")
speed_multiplier = 0.0
friction_multiplier = 0.0

[node name="idle" type="Node" parent="Entities/Enemy3/StateMachine" index="1"]
script = ExtResource("5_3wcfp")

[node name="Transfer_West" parent="Transfers" index="0" instance=ExtResource("7_6ttik")]
position = Vector2(16, 256)
rotation = 1.5708
facing = 2

[node name="interact" parent="Transfers/Transfer_West/StateMachine" index="0"]
direction = 4

[node name="transfer" parent="Transfers/Transfer_West/StateMachine" index="1"]
level_key = "LEVEL_CASTLE"
destination_name = "Destination_01"

[editable path="Transfers/Transfer_West"]
